networks:
  mellonpass-network:
    name: mellonpass-network
    driver: bridge

volumes:
  mellonpass-postgres-data:
    driver: local
  mellonpass-tmp:
    driver: local

services:
  mellonpass_server: &mellonpass_server
    build:
      context: .
      args:
        POETRY_INSTALL_OPTS: '--no-root'
      target: local
      dockerfile: Dockerfile
    container_name: mellonpass_server
    labels:
      logging: "promtail"
      logging_jobname: "containerlogs"
    restart: always
    stdin_open: true
    tty: true
    environment:
      - APP_ENVIRONMENT=local
      - DOMAIN=localhost
      # Persistent storage.
      - DATABASE_URL=postgres://postgres:postgres@mellonpass_db:5432/postgres
      # Django admin.
      - DJANGO_SUPERUSER_PASSWORD=admin
      - DJANGO_SUPERUSER_USERNAME=admin@example.com
      - DJANGO_SUPERUSER_EMAIL=admin@example.com
      - SECRET_KEY=django-insecure-secret-key
      # Test user.
      - TEST_USER_EMAIL=testuser@example.com
      # This raw password is related to the TEST_USER_LOGIN_HASH and TEST_USER_PROTECTED_SYMMETRIC_KEY values.
      # Raw password: v}}\a5X%pEPn7d$n<L@-
      - TEST_USER_LOGIN_HASH=11b0ca97c2a0f88bd4a0907729c38eca7224130ff09b8b42d81f163f4cb44363
      - TEST_USER_PROTECTED_SYMMETRIC_KEY=YTRlZGVjYTZiZjJiOGM3YjNhNDNlMjE1ODQzNTJmODM1MzE4NWY0ZWM5Zjk0NzJhZjQyZWIzMWU1NzViOWY1NDVkNDVlYzdjOWRjYzY1ZjFiMzNlZjhmMTY4MTQwYTMyNjljNzc5NzNjNmViZjdmNjQ1MjFlYmM2OWRkMjU1OTRkMDBiNmY5NzI4MTBkYWI1OWYxY2EwMzJiMzEyYTQ0M2Y5NTRjZmYxY2U5N2RiYTg2MzFjMzBiOTVhN2I2YjFkNGQxY2U4OGJiYzdmM2M1MGRmNGIzMDUwOGQyZjk5MjA=
      - TEST_USER_RSA_PROTECTED_PRIVATE_KEY=OGY0YTFlODkwODVjOTQ4NWJkNTljMDFmZjRjNjk4MjNhZGVlYWRkN2NkYTdjYjA2YjhiZWFmZDA3Zjk2ZDg0MDRkYTczZDIwM2EzYmRkMzExZmM1Mzg5M2E5MDk3MDJmZGJmOWZmM2JlNzU3MWFhZmI2ZDBjM2RlNDQ0NGRlMjUwNmFmZjUxNDNhOGRkZWZjMTBkZmYzNjM0NjBmNGY1YzBhNTM4YzcxNTU2MTUxM2YxMzQ2Mzk0N2RiZjIyM2U5Njg1MmNhNTk0NDQ3OGQwMTEyNmZjMTQ5NDc4YmMwMTVlZTExMWMzNWRlYjk3OWIxYTI5M2E2Zjc2M2JlYzA4NmRhYjY3ZjU1ODE4YzIyNzkzYWUyMmVmMzBhNzkwMjI5YmE2YTZiNGNlZDAyMWQ4MzM5Y2YxYzUzY2ZkNjA3YmMyYjJlNTA4OTRhMmMyODQ3NGNjYzkxMWM1ZmYzZTNjZDc4MzZkNDJkNTkxYjJmNjZkNTNkYmFkOTFjYWFmNTVlMWZhMTk5YWRhMTRmMGI4ODk4YjM0YjgxYTQ1Mzg0OGJmNTI2OTQxYjkwOGRkY2MyNTQzNGM2ZmMxZDgwMjg0YzY3NmMyZjM2NmI1ODc2MjkxZDYzYWQxNzY3YzhmOTI1OTMyYThhMDQ4MmNjOTE2MWJjN2NhZWViNWMwMTdlNWFjMjdmOGJjNGYzMTAyODdjZDI4MTk2YTM0Yjc4Y2FkYmI4ZTYxZDczYmU3MTQyMGQ3M2U5YTk0ODk0MDEyNjg5ZDg1MGRkMGU2ODU4N2YyODQ3NWE1NGZlYmZhMzhkMjExMDk2Mjc1ODNhOWZhNjA3Mzk0YTFhMzAyYjliMTY0NDk5MDRiOTEzMzEzMmRlNzZiY2IyYWEwMjE3NWMwZDkwNDhiNTZmMDU5OGM0MmJlZDE1ZjBkMGRjNTQ1NmFiZjY0NzQ0ZWYzYjY5NjAzYmFhOTE2YTQ1MTM1MTExMTI2ZGJmOTYxYjc5ZTdmNmM2Yjc2MTYyNDIyZjhmOTYxZDNiYzNjNGI3NGE4NDQ2YTQ5MWZiYmNmYjA0YzdlOGIzZGZjZmIwMzZkMjIxYTgyOTA0Mzc1OGY5MDU3NTYyZWZjMjA3YTU3ZWE3ZGU1Mjk4YjVkZDUwNTA4N2Q4NWJkNTlhMjc4NDBjMTA3YjRhNjQ1MDE5MTFjNWQ0YzJkMjVmYTM5ZTc1NjE3YmQ2OTdiZDJiNDE1ZjE3ZDJmZGM2MTJmYzI0MzUzNjgyMDBhYjZmYjU2ZTc0ZTc4YzhiZjIxNTE2MmVmYjNmMDQxNDBmNDA1Zjg0NjQ1ZDA5YmJiODlhYTRkMGM4ZjhiM2E4MWZhN2I0ZWE4ZTA2YWQ4ZTgxODUyZDQyNWRlYWZjMzM2ZmFiODMyOGMyYjJjZTc4ZGE2YTdhYTc1Y2M5MGVkNWE3MDhmYjczNmYwYThkZTM5MTY2ODRkNjI1N2Q2ZWU3N2ExZjMzOGZmMDViODY3NzFmZjc1N2QyOTNmNWU5OWYxNjRiNmE3ZTU5YjZjNDJmMGM5OWUyODk4ZmMyYjIzYmY4ZDY0ODQ5N2Y0MDRhMzU2OThkM2JkNTVkZjVkYmY3OWFjZDE1ZTliMTQ0YjJmYzdhOTk3MTU5MDg4YTU3NDM4MjM4MzNiMDYxNTM2YTBiYmM2NDdkZGI3MjJkNzk5ZjYxYTIwMDg0MWI2NDYxZGQ4ODU0MWVkYjFmMDljZDM5NGFhODgzZjJmZjVkNjk4YTBmMGJjYTg1ZjA4MjgyYTI5YzI1MjlmNzk5ZmI4NGVjZDhiZGU2MzIwOWE5YzVjYzg0YWQ3ZWM3NTcyMmVmMGQ1ZDUwMGM0OTdhZGU4MzhlMjQ3MTc4MjMzYmNlZjBhMWQ2ZDcwMGEzMjU2Y2RkNGE4NmMzN2YwMzVmMDY1ZGFhNTAyMTgxZGY5ZWQ2ZWJkODZjMmFkYWY3YjFjZGNjMzkyYWVhNGYyNTRhN2Q5MDdlM2ExMjEwZjdiZmM2Y2FjMTY3MzJhZTNmZTY5NGIxYWUwZWQzYzJmOThjNGUwM2JhNzg3N2U4ZGI1ZjJjOGNhODk4MDEyMjhmMDRjMzBlNmYyY2FjNGZhOTRlNzI0YWVjYzYwNzgxMmY2NGVhOGI1ZTI3NTdiYzJmM2Q4N2VlYTgzZWZlM2Q5NzFhODU3MjRjZTQ2ODkxZDk5ZWFmNmQ4ZDk3M2RiNmE3NTNlNzBkNzM0ZTVkNTU2OGRhOTE0NWM2MWRjZjMwMzc1MGNmN2RlY2I1NjI3YTVkMmFjZjE1M2RkMWYxODcyMWJjNmJmMDhhZGE2ZTI4ZGNhYmQ2MjNiNTRiZTM0M2I5YTc5MGM3NmY2MTNmODljYzI0ODc0NDk5NzcxMTBkYmJhZWRjOGM3Y2ZlYmNkMGJiZDExMzg5ZDJhZDVlNTM1Zjc5OThkOTBlMjMzY2NkYzlhNjFmYTA3ZDdjMDE3NWYyYTBlODY3YzE0NjBkZTI1MTFmNmU4YWMzNWI0YWEzNTYxZTZjNjQ3OWExODE4ZTBlNjljMGJlNTViYmEwM2Q0ZjQ1MWE3OGM3Mjg2MmIzYmU0ZTExMTJlOTRjNmIyOWU2ZGEwNDViMGRkNWRjZDA0M2FjNjgwODQ0ZTRkM2E2MDM4ZTZkYmY4NDNkM2U2MWMyNGI5N2NjMGU5M2EwNDgwNjRiZTYwNjZhZmMxOGVhNTQ3NDgwZDlkMzVlZjFjZjM2MzEwZWEzMDIwMDBiOTgxM2FhNGY0YTFjYzUxN2Y2YmM2YTk0N2Y2NDY1YjU5OTQ5MzhjZjJmMTVjNzllMTdhYmUxODdkOGI5MDUzN2IyMjY3MTJkYWFmZjE1ODgwODA1NDcyYzI1N2UyOGQzOTBiMDZiNzliNGViNTYyZmEzNTU3Y2E2N2FlYWU5MjE4ZGYwYzNjNmIxNDQ5MWYwNGJmN2JhNDUzNGM4NjZiMWEyZGUzMDk3MzhiYjA4MGQ5MmIyYjA3OTYwODg4N2FjY2IwNTg4NmQyMDFlNjcxYzVjYjYxZWZiOTE0MzliM2VlM2ZjZTkzYTY2MjY0Y2NmOTg3ZmY5M2ZjMzUwZGI5NWRhNTIzNGI0Nzk4ZDcyMDgxNjQ5OThkYmM3NjQyMTE5MGU4MDE0YWZjNTdiYTM4N2Y1YjQ1MTkwM2QwOTMwMjlhOGQ0NDc3YjY2NTJjNTU1OTQ4ZjkwMzk4MTU2ZmFhZTA1ZGVlZmJlNWM2MTZhYWU1MmU0ZjAyYTViYmZmYjdkNzZmYTlmYTdmZmVhYWQ4ODc0ZmY1OTM2OTEwNmRmMGRkNWE0NjI3ZjFjZGYxYjAwNTJiZGQ5ZjFlMTQ0ODRlZTYwNGE5Mzk0ZDA3YWY0NmNjOTAyNTA5YTIzYjYwMTY1MWViMDU2NDMzMjY3NGEyNGZkYzNmOWUyZTEzNzU3ZjdmOGQyOTI3OWY1ZWNiYjMzYzJlYWE4ZDBkZGMzN2YxOTllOWIwZWQzMDZlNWY2ZWIxNWIzMDRkNDU2ZDEyMDFkOGFkNDFmOTYxMDg0YjhmODRkZDI3YTc4ZTY4NDNmOTM5ZWQ2NjE0M2Y4OWZlMzU1ZmM5NzZiOWYyZjI5YmY1MTY2N2NlNmYwNWI1MDFiYWIzYWM2YTU3NzliY2JlOWExNzQwNDg5Y2M0NWZkNzA3YzM3YjE1ZTI5ZjMwMjEwZGRhNTUxNWE5MmYzNjUyMDA2NDQ4OGRlNWZkMDU0MjZiODAwMDBjYTY4MDY2NzExZTk1Y2UzNzhiMDI0OGY4MjM4NWUwZWYwYmU1MWY0MzNmYWQyMWU2MTc2ZGQ5ZWE2ZGZlMjMxYmZmNzVkMzU3NzliMTMyZGE5MmZmNDI2ZmMyZDQ4ZDkxMzFjMTQ4NDRhZWFjNDllMTU1YTA5YTJhNzQzNDgzODA3MjRlNjU1ZjAzYmNiYzZjNWFhYWMzZTA4ZDM4MjIxZTBmZDVjY2E2ZTZhMDVkNGY5NDQwMTE0MThjZTI1NjQwYzkwYTk3Y2ZiZjk4NzdiYTllMTMyNTRlMWZlNDI3YTQyNGZkZWU2NzI2MTVjM2JmNzM5Zjk0OTNmMTU0NmU4YmExMmNjZDNhOTllNDY1MmRmZDJjYjE2NjE3NjY5NzVmOWFhMzcwMjg3ZTU1NTQ3MmM0NzM5ZjdjOWYxOTk3MjMwNzlmYjVhZGFmNjg2MzIxOWVlOGVkYjZhNzRhM2QyMDQxNTc3OTNmZjBjMjdhZTVhYWQyYjI2NWQ3OWFiZDJmMGNjNDY5NTRhMWFlNTdlMTMxNWM2NDQ5ZWNmYWQxNjhmMTNhMjU5ZGU4NmEwN2I5ODY5NTQyMWFlMGJjZDJhNzZlOGZhZjM0N2RiZDlkMmNhOTE3ZmU4N2UwYWY2NTU5M2FjYjUwODA2YWI1Njk2YmRkZDM0ZmZkNzllZGY2YTUwMzFhMjE1OTFmZmExYzI5MDZjZDdjZTc1YjY0MTFkMTBiNDMzMTc2MzY5ZDRhNTRlYTUzMjFiMzViNGE4MjNmN2NkNTdlYzEwN2Y3YmYwNzkwZTY4YjAzY2E3MTY3Y2RjMDU0ZjFiMGRjMjk4NmZmNjEyZTlhZThlODQ0MDBmOWUwMzAxMWM3YzNjYzBjMTEyODU0Y2E2MDBjODIxYzQzMDI1MjYwNjBlYzhlMTNmMGQxNWY0ZDgzZGExMmEzYWIxNmNkMDA2ZTFjM2RjYzkwMjY1YjAwNTU2ZmRlZTVlYzAxOWVjZDkwYWI3YWNhNzUyM2RkOGJhMTQ2ZjM1NTdkNmJlMjQxNzE5N2U5NDE1OGY0YzQyYjI2MGMxYTEyYmIwMDhiZDI2YjE3YWY4Y2U0OGJhNWM4OTBiMTQzMmIwMDVhOTFjMjg4ZWY3MzQwODYwZWFiMTM0N2FiYjdmNTQ3YWY1M2VkMjA5NDNjNDQyZmQxNmJhOGM2MWRlNzZiNDVkNDAzNzAzM2Q4ZDg5YzEwOWFjODgxMWE1Njc3MzMyMDllNDg3NTZkNWVhZjQxOTdmNjI5OTE1NzU2N2Q3YzNhM2Q3YjYwYzI0MWYwMmFhNTEwYzM4NmU1Yzc5NTJjMjE5OGFiNWQwMTk5NzY4ZWJiMTRlNDBkOWYyNjI4MzJjNTVhYTJkMWMyN2RkMWUyOWMyYmVkMmRkYTA2MWU3ZTViNjNhODRmODIzNjk5ODY5ZTJiNmQ3MjkzOThmMDBjYzY2ZTFlNjVjZDAwNDBjYjgzZmE4NjQ3Mzc5ZWQ5Njk0ODE5N2JkZjVmNDRjMzc5YWMxNzRmNmU0N2E0OTQ4YjE5OTYxNmUzYzAzYmQ1ODI2ZjRiMGE0NzkzMmFmNmM4NDM4M2RhMjIxZDVjM2E5NTliN2YzOWMzNTk1MGMyZjhlYTc5OTBjMWFiYzBmZTYxOWY3NjA1MTlmNTBhMjVkMjEwODM0ZDVmNmVhYmI5YWExMmNiMmJmYmNhNDcwZDRiY2MzZDkzNWFiYzBiMjVkZGM5ZWM5OTA2NjBiZjg0ZDhhY2FiZWY3ZDY0ZWY4Y2EyNWYxZjI2YTk4OTVhMDAzNTI4YWEzZDNkMTQ1NWU5OTQyYzUxYWIzNThhZmYwNzJlNTIwN2E4OWYwNThkY2I3Y2Y4MmIwYzJhYjcyNjU4ZWUwYzAwZGExNDc0NTljYjk5ZGM3YmU5MjdkN2U5M2NhNGZkODM0YzRiN2M3YzUyM2RkMDhiYzdiMzhmZDBmNjdlNGYzMGExZmQ5ZmIzMDcxYjljN2UwMzFjMjNmZDA5NzYyMjU4NmUxMWY3MWEzOGEyYzdmYWNkNjc3ZmM0OTU3ODQ0NjYzZjRjMGRiNGFhMDJiMzExNGI5MGU4NzM0ZmI2YWFlMjBiYjA1MDZjZjVhMmRmODI0OTQyMWQ3ZGQzZTFmNzFiYWRjZDk0NjQzYmM3MDJjMzYyMDUyYTU2MTgyMThmYzFjNGIwYjVjOThjMmZlMTQ4MjY1M2ZlMGZlMWMyNDhiMWE5M2JhNmM2YWRhN2YzYTUxZDk2OWZlZmUwYWRiOWNiZDY1M2MwOWRkNGE5NjEyZGY4MDRlYWQwOGYxYTIzZTIwZWM0MmQ1OWQ4ODljYTkwOTI3OGJlYjgwZjVjZDM2ZDBhZmRjNTRjYzc1ODFjYjM4NjgyMmNkNjEwYjQ1NjdlZGM5YTNmOTAwMWJmN2FlOGU0NGI3MGI5MmRlMWY2YmExOTJhMDQ2ZjM0NWVkNDUzODI5NTdmOTkyYzQ1ODkyZmZhMGYxZjM3OWZhOTc3ZDk3YzQ0ZWQyN2I1NDI4ZWQ5ZDlhOTMzNjEwYzRiNjY4ZThmM2NiOWI2ZjJlYjM0ZjQxN2RiYTU1ZWUzMzEzOWJjYTVlMzA1OWFjOGExMTU2NWRiNGU1MWEzNjM4MjljZGJlNjUwMDAxMDIzNjIyODM5ZjY2NTNiMjMxZWQ4NWMyMTQ0OGNhZWE3YzVkNDk1NmQwMjdlYjY0N2U5NGY1ZDFhNTcxNmM1MmIxNTYzMzFmZDViYjU0OTk0NGZlZGIwODhlMmIzMmY1ZmNmN2Q0ZTUyNDA0NDkxM2I0YWVhYzE5M2UwYmI4ZDgzOWJkMzcxMzM2MDBhMDAwMmExZjkyNmQzOGU4ZDJkZDIzMGZmNTQyM2I0N2E1YmM5NjY1YWFiMGQ3Njg3NmRmNjhjZjYyZmJmYzdlZGY0M2UyYWQ3MGJjNmY3NTQ1OGIwNjQ0YThkY2ZlNmZiMWZhZjFkNWFkZGE1NWY0ZDQ4ZTkyZDM0ZjBiOWViYzM3M2IwNmY5NjFhNzA0ODQzNTNiZWRjNDU4ODc4YjU4MDQ1MWQyODJlZjRkYTM1NTE5ZGM3YzUxNGVkNzVjODk2YjQxZmQ0OWJlOTgyZTM4ODEzMjliNTRjY2U5NGVjZTA2N2M5ZGE3YWU4YWZmMTc5NzZjZTQ1NmQ0MDFmNjkyMjI1MWFkZWYwYzU5OWI0YjQ1OTJlMDEwYWIzODJlNWY2OTIyMjA4ODAyNTllM2Q4YmQ0Y2EzMjEzYmZiNTY4ZWE2NmZmMGM4YmYzZTEzZTVjY2RmMDBiMTVlYThkM2Q0ZTc0MjZjZTYwNGY0ZTIxMTA0NWQ5Y2YxMGUxNThjMWY0YmFlNjg3Y2VmYTQ2MDhiNWIxNjczMDRjYjBiYjA1ZjBjZjQwZjBjYTYzMjZiNzRhM2NmN2VjZmM5YzE0ZWI0NzI2M2JmZGQzMWNkYzU2NzFiMWI0NDVhY2U2NjMyYjRkNjlmN2JkMjU1NmE0YmFmMTRlYjc0MDQ5OTgyODc5NmQxNWI4MzY4ZjJlNTE3ZDliZDAyMjk0NGZkZTY3OTkzMjIyNjJhMjFjMWFiMTE3YmQ4M2I0YTk4OWRjYWU2YzM1YzBhODdiMmY5Zjc0NDVjZTU3ODZlZDgxZjllZjg1YzJiYzRkODNkMTE1Nzk1YmRlZmIxNDFhNmQwMThhZDNlM2M5YTU0YWE0MGM3YmIzNTVmMjE3ZDc4OTc3YzA5OWRiNTRiMjU3ZWVhZTE0NDllYjUxZTk0ODFkMWEyYWNmNjBjYjlmZTk0ZjQzZTc1OWQ3YmQ3MTRlYjI5ZmVmMDkxYzkzYmRhYjIzYzljYTY4OTljYzE4MzY5ODllMzlkZTBjOWZjMWRiMDA1NzJiOGUwYmIwNDgxNTQwY2I5MTA4NGQxNDE4YmQ2MTMzMDliY2RkZDIyYTM5NGY0OWY0YjU5YjI2MGE5ZjBiZDAyNjcxOTQ5ZDEyZjYyMDkzNzdkZmFhNTUxNTZiMGE4MzllOGFhMjRhYjdmYzRlOTJmMDFlMTBmMzI1OGNlNWE2MzAzOWE0Zjg1Zjk5NGEzZGFlZDY1NGI2NThhNmE1N2VkNDFkOWEzNzM1NjJhZjYwZDU3YTYwMmNhMzIyMTIxNzk4OGM0NWNkNzJmYTc3ZTUyZjAzYWMyZDMyNjk3MjFiNDc2ZDI3MzlhNTRjYmFjYTI1ZjkzNWFkNjY3MjJhNzkzMWZlMjFmNzU3YjQ1N2U2Y2Q1YjRkYmFmNTFhNGRlMTg1NmExZTczYjJmODMyODhkM2I5Njk4YTZmMGExNDdlZWZmZTJjMDNlYWM4ZTQxMDFlMWVkYWY0MjgzZGE1NmI2ZDU3N2EzMmFiNzI2ZGZmMzNhM2VhNThhOTQyNTk4OTViZWVmYmI1YTk1ZDY3MjIxZjhjYjJjMTEwYmZjNGQxMDk5MGI0ZjZjM2ZjMjExMDRhZWQ3Y2ExYTVhMmU1OWYxZTEzMzIxZjc4MDU0Y2M5ZDhkODg3MDlkNzBjODkyZjIwNjA3MjMyMDI4NGM4NDAxNjRlZGRkNTE0N2Q0MGViNGIwNDM3M2M4NzRiM2UxZDRjYjQ1NTY0Y2E4ZThiZTAxMTE4NTNhZjg2NzE0ZTIzN2ZlMjA1ZjQxMzE4MDgyN2UzN2EzZDQxZDE2ZDIyNTg3Nzk3NmMxODBhNDM2MjQ5MjZmZjVlNTg3YzNiMmUxY2UyMzg3YTNhNGYzNjBkYmRmNDg0ZmFkNjFlY2Y3Y2QxMmJjOTgzYmQxZDdlMWJkOTI2YmQyYjdhNzIwNTNjMWM1YmZjNTgxOGQzMWZjYjU3YzdkOWQyNDc5NmEyNzk3ZDk2ZjdmZWI1MGFmMzAwZDUwMjExMTk2N2QxOTg2YWNiZjljYTczMWQ4ZWFhODdiZTAyMjFkNWFlY2VlNmQ0OGFlNThkMGJmMGM5ZGQyZjhmMmI3MzY3NTQ1NGIwZTk2MDcyMzM2ODYxMw==
      - TEST_USER_RSA_PUBLIC_KEY=N2IyMjYxNmM2NzIyM2EyMjUyNTM0MTJkNGY0MTQ1NTAyZDMyMzUzNjIyMmMyMjY1MjIzYTIyNDE1MTQxNDIyMjJjMjI2NTc4NzQyMjNhNzQ3Mjc1NjUyYzIyNmI2NTc5NWY2ZjcwNzMyMjNhNWIyMjY1NmU2MzcyNzk3MDc0MjI1ZDJjMjI2Yjc0NzkyMjNhMjI1MjUzNDEyMjJjMjI2ZTIyM2EyMjczNWE3YTYxMzMzMDRiMzEzODM1NmE1NzQyMzk0ZjZhNTc3OTc4NWE0OTQ3NDE2NDU2Nzk2MTU2NWY1MjY4NzI2NDQ0MzM0MTM2NjQ0Mzc0NGQ2YTZhNzczMDQxNDIzNDQ5MzQ1NzY3MzA3MjU1Nzg3MTM1NmE2NDQ2NDc0YjQ5NjI0Yjc5NzA0ODQyNTE1NzM0MzY0NzRjNjIzMzQzNDY0MTQ0MzY1MjUxNTM0OTUzNDU2ZTZiNjE1NjQ4NTc0MjRiMzE1MDZjNGQ0MjY1NjE0YTM2NDg2MzZjNGUzMjY4Mzg2NTU3NGE2NDU2NTg3NTVmMzY2NjU5Nzc2ZjY0NTIyZDc3NTYzMTUwNWY2NzQyNGYzMTRlNjI0YTUzN2E0NDUzMzc0Nzc1Njc1ODU5NDk3MDc3MzY1ZjMwNDU0NzU2NjU2NTZlNGQ3MjU1MzY2OTc2NTQzMzU2Nzk1NjcwNDIzNDRkNTI2ZTU2NGM0ZTcwNDc3MTUwNzYzNTU5NzQ3YTQ0MzMzNjUwNmM1MTQ0Njk2ZTM0NTAzNzcyNDcyZDQ0NDY3NjY4NTU2NTU0Njk0NDY3Nzk2YTQ4NzI0ZDQ0NTc0ZTcxNDk2OTQ2NGY2MTZmNzE0OTZlNjU0NjZlNmU0NjU4NTY2ZTc2Nzg2OTU5NTk2YjY2NGE1NzUxMzI1OTQ3MzcyZDU5MzE2ZjM2Nzg2OTdhNmIzMzY2NmI0YzRiNjk0MjMzNWY0NTMwNGM2MTMyMzg3NDZiNTI1YTMxNjEzNzY1NTI2MTc5NGI1NDVmMzEzMzY0NzQ0Njc4MmQ1NjUwNjE1NDMzMzQ3MDMyNmY0NTVmNmU1MTQ5NTM0MTQ2Njk2YTcxNDg2NzJkMzM2NjVmMzA3Nzc4NjQ2ZjQ2NmI0ZjZmNTk1ZjM0NmY0ZDc2NjEzMDRlNWE0YzYxNTM0NjRlNmE1NDQ2NDU2MzY0NTY1MjQxNmQzMTYxMzY0NTQ1NDg0NTUxNTk3NDYyMzY0NDVmNjk0NjJkNmI2NDcxNmYzMTVhNWY2YjM3NTE2NDM0MzU3NTdhMzUzNjc5NmM3YTdhNzU0MjY0NjU0MzZlNWYzMTMyNTM2NzY2Njg2NDZkMzgzNzM2NDQ2YTQ2NDc3YTRjNDU1NDY3NGQ3MDVmNjc3OTM3NTAzMDUwNmQ1NjM1NDk3NzY3MzE0YTZkMmQ1MTRhNmUzMDU3NzYzNzZiNGE0NjM3NDQzODRiNjE1NDQ5N2EzNjZhNmY2NzVmNmM0NDVhNTk3YTU0NmQ2MzMyNjg3ODU0NmY3NTZjMzg0ODRlNDI3NzQzMmQ1NzUyNjc0NzcyNzEzNTM5NTM0NjQ0NWE0MzMxNjc2NjMzMzEzMDQ4MzQ0ODU4NGE2MjZjNmQ1Mzc5NTM1MzM5NDI0YTY4NjUzNDQ3Njg1Njc1NmI0Mzc1Njc0ODcyNzY1MjQzMzg0ZDc1Mzk2ZDRkNmM3ODY2NTU1MzM2NGMzMjQ4NDM0YjRjNzEyZDMzNDI3YTQ0NmM3NDY4NzA2ZDZmNGEzOTM2NzUzNzU5NGIzNzM1Nzc2ZjU2Nzk2YzY4Njg2NjJkNWY0NTQ0NzQ3MTM3NmI3MDdhMzc2Yjc3Nzg3MTc3NTA0ODM1NmI0OTYyNzg1ZjZhNGE0NzYyMzM3OTM0NmY2ODMzNmQ2OTcwNDQzNDM4NTc2NTRhNDU1MTQxNzEzMTU4NGY3MjRmNmQ2YjZhNjE1MTM3NGM0Nzc4NjE2ZDY1NDI3NDRiNGI2YTRjNzA3OTRlNzA1MTY0MzU0ODYzNWY2MTRiNmU0ZTZiNTU1MjZiNDI0YjMyMzU3YTM2NGQyMjdk
      # Security.
      - ES256_PRIVATE_KEY_PATH=mp/jwt/tests/resources/keys/private_key.pem
      - ES256_PUBLIC_KEY_PATH=mp/jwt/tests/resources/keys/public_key.pem
      - DB_SYMMETRIC_KEY=IFdjlMcWEjpswSDoOhiEhsQXugioBs_Pbg5z1J8G91U=
      # Cloudflare.
      - CF_ENABLE_TURNSTILE_INTEGRATION=False
      # If CF_ENABLE_TURNSTILE_INTEGRATION is enabled you need to provide value for these variables.
      # - CF_TURNSTILE_CHALLENGE_API=https://challenges.cloudflare.com/turnstile/v0/siteverify
      # For more secret keys, see: https://developers.cloudflare.com/turnstile/troubleshooting/testing/#dummy-sitekeys-and-secret-keys
      # - CF_TURNSTILE_SECRET_KEY=1x0000000000000000000000000000000AA
    volumes:
      - .:/code
      - mellonpass-tmp:/tmp
    ports:
      - "8000:8000"
    depends_on:
      - mellonpass_db
    networks:
      - mellonpass-network
    command: /start_web

  mellonpass_db:
    image: postgres:15-alpine
    container_name: mellonpass_db
    ports:
      - 5432:5432
    environment:
      - POSTGRES_HOST=postgres
      - POSTGRES_DB=postgres
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
      - POSTGRES_PORT=5432
    volumes:
      - mellonpass-postgres-data:/var/lib/postgresql/data
    networks:
      - mellonpass-network

  mellonpass_huey_consumer:
    <<: *mellonpass_server
    container_name: mellonpass_huey_consumer
    depends_on:
      - mellonpass_server
    ports: []
    volumes:
      - .:/code:ro
      - mellonpass-tmp:/tmp
    command: /start_huey_consumer
    networks:
      - mellonpass-network
